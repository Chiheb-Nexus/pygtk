2004-03-09  Johan Dahlin  <johan@gnome.org>

	* gtk/gdk.override (pygdk_filter_func_marshal): Impl.
	(_wrap_gdk_window_add_filter): Impl.

2004-03-08  Gustavo J. A. M. Carneiro  <gustavo@users.sourceforge.net>

	* configure.in: Remove leftover definition of gtkgl_required_version.

	* gobjectmodule.c (pyg_enum_add_constants): Delegate to
	pyg_flags_add_constants if the GType is really a flags type
	instead of enum.
	(pyg_flags_add_constants): Delegate to pyg_enum_add_constants if
	the GType is really a enum type instead of flags.  Based on John
	Ehresman's patch.  Fixes (better) #136204 (GtkTextSearchFlags warning).

2004-03-07  Hagen Moebius  <hagen.moebius@starschiffchen.de>
 
         * codegen/docextract.py: avoid the non-uniform behavior of gtk-doc
         to have an imaginary "returns" parameter. it is converted into the
         <return>-tag.

2004-03-07  Gustavo J. A. M. Carneiro  <gustavo@users.sourceforge.net>

	* examples/pygtk-demo/gtk-logo-rgb.gif,
	* Makefile.am (EXTRA_DIST): Add gtk-logo-rgb.gif, because of stock
	icon registration example.

	* examples/pygtk-demo/demos/appwindow.py: Fix stock icon
	registration.

2004-03-06  John Ehresman  <jpe@wingide.com>

	* gtk/gtktreeview.override (map_expanded_rows_cb)
	(_wrap_gtk_tree_view_map_expanded_rows): Wrapper for
	GtkTreeView.map_expanded_rows.  Fixes #136309.  Review and minor
	enhancement by Gustavo Carneiro.

	* gtk/pygtktreemodel.c (pygtk_generic_tree_model_iface_init)
	(pygtk_generic_tree_model_unref_node)
	(pygtk_generic_tree_model_ref_node): Add support for optional
	TreeModel ref_node & unref_node callbacks.  Fixes #136312.
	Reviewed by Gustavo Carneiro.

	* gtk/gtktreeview.override (pygtk_cell_data_func_marshal): Fix
	reference problem on cunote->data.  Fixes #136306
	( pygtk_cell_data_func_marshal ref counting in 2.2.0rc1 ).
	Reviewed by Gustavo Caneiro.

2004-03-06  Gustavo J. A. M. Carneiro  <gustavo@users.sourceforge.net>

	* gtk/makefile.msc: use PYGTK_CODEGEN_DEFINES here too.

	* gtk/gtk-types.defs: Make TextSearchFlags an enum or flags type,
	conditional on HAVE_GTK24 being defined.  Fixes #136204.

	* gtk/Makefile.am (.defs.c): Pass $(PYGTK_CODEGEN_DEFINES) to code
	generator, for conditional compiling of GTK+ 2.4 features.

	* configure.in: Check for gtk+ >= 2.3.4 and, if found, define
	PYGTK_CODEGEN_DEFINES="-DHAVE_GTK24".

	* codegen/defsparser.py (DefsParser.ifndef): Implement (ifndef
	...)
	(DefsParser.ifdef): args no longer includes the function name
	(ifdef) as first element of list, so needed to offset indices to
	make it work again.
	(DefsParser.ifndef): idem.

2004-03-05  Johan Dahlin  <johan@gnome.org>

	* codegen/codegen.py (Wrapper.write_constructor): Cleaning up
	write_source and starting to refactor Wrapper a little bit, to
	avoid so much code duplication

	* gtk/gdk.override (_wrap_gdk_pixbuf_fill): This should fix both 
	bug 136205 and bug 136205. We're now allowing both long and int
	and converts them properly.
	
2004-03-04  Johan Dahlin  <johan@gnome.org>

	* gtk/gdk.override (_wrap_gdk_pixbuf_get_pixels_array): New function
	(_wrap_gdk_pixbuf_get_pixels_array): Deprecate, in favor of
	.get_pixels_array(), based on Patch by Tim Evans, fixes bug 90255

	* pygobject.c (pygobject_chain_from_overridden): 
	* pygtype.c (pyg_signal_class_closure_marshal): Fixes for bug
	132704, Patch by John Ehresman.

	* gtk/gdk.override (have_numpy): New function, to initialize/check numpy
	(_wrap_gdk_pixbuf__get_pixel_array): Use it here
	(_wrap_gdk_pixbuf_new_from_array): and here
	Patch by Tim Evans, fixed bug 122786

2004-03-03  Graham Carlyle  <gcarlyle@cmedltd.com>

	* gobjectmodule.c (pyobject_free): block/unblock threads around
	Py_DECREF, because we may not hold the interpreter lock at this
	point.  Fixes #135963 (gc of gtk.ListStore aborts intrepeter after
	gtk.threads_init() called).  Reviewed by Gustavo Carneiro.

2004-03-02  Johan Dahlin  <johan@gnome.org>

	* gtk/gdk.override (_wrap_gdk_event_tp_getattr): Add
	GdkEventKey.hardware_code. Fixes bug 129032, patch by Laur Ivan.

2004-03-01  Johan Dahlin  <johan@gnome.org>

	* codegen/codegen.py (Wrapper.write_methods): Check for defined
	methods in the override file.
	(Wrapper.write_functions): Ditto for functions

	* codegen/override.py (Overrides.__parse_override): Clean up a
	little and add some docstrings. Also add a new keyword, define
	(Overrides.get_functions, Overrides.get_defines_for) 
	(Overrides.function, Overrides.define): New methods.

2004-02-28  Gustavo J. A. M. Carneiro  <gustavo@users.sourceforge.net>

	* gtk/gtk.override (_wrap_gtk_accel_group_connect): Add wrapper
	for gtk_accel_group_connect.

2004-02-24  Gustavo J. A. M. Carneiro  <gustavo@users.sourceforge.net>

	* gtk/gtkmodule.c, gtk/pygtk.h: Make pygdk_rectangle_from_pyobject
	a public API function.  Fixes #135279.

2004-02-24  Johan Dahlin  <johan@gnome.org>

	* gtk/gtk.override (_wrap_gtk_stock_list_ids): Plug a leak.

	* pygobject.c (pygobject_chain_from_overridden): signa->signal

2004-02-23  Gustavo J. A. M. Carneiro  <gustavo@users.sourceforge.net>

	* gtk/gdk.defs (GdkDrawable.get_image): Add caller-owns-return, as
	suggested by John D. Hunter.  Fixes #133681.

	* gtk/gtk.override (_wrap_gtk_menu_popup): accept large long
	integers for the 'time' argument.

2004-02-23  Xavier Ordoquy  <xordoquy@wanadoo.fr>

	* Makefile.am:
	* gtk/Makefile.am: applied patch from Naofumi Yasufuku. Fixes
	bug 121339 (dsextras.py installation directory).

2004-02-22  Gustavo J. A. M. Carneiro  <gustavo@users.sourceforge.net>

	* gtk/gdk.override (_wrap_gdk_pixbuf_new_from_array)
	(_wrap_gdk_pixbuf_new_from_array): apply Tim Evans' patch to
	create pixbuf from data (string) or from a Numeric Python array.

2004-02-22  Xavier Ordoquy  <xordoquy@wanadoo.fr>

	* codegen/h2def.py: don't expect a whitespace after the type name
	Fixes bug #128988, patch from Jon Willeke.

2004-02-19  Gustavo J. A. M. Carneiro  <gustavo@users.sourceforge.net>

	* gtk/gtktreeview.override (pygtk_cell_data_func_marshal): Fix
	multiple python object reference leaks.

2004-02-14  Gustavo J. A. M. Carneiro  <gustavo@users.sourceforge.net>

	* gtk/gtk.override (_wrap_gtk_binding_entry_remove): impl.

	* gtk/gtk.defs (binding_entry_remove): remove gtk_ prefix from
	function name.

2004-02-10  Seth Nickell  <seth@gnome.org>

	Reviewed by: random luser <kiko@async.com.br>

	* gtk/gdk.override:

	Change type of argument in signature for gdk.event_get_axis
	from "d" to "i" so that get_axis works

2004-01-14  Johan Dahlin  <johan@gnome.org>

	* gtk/pygtktreemodel.c (pygtk_generic_tree_model_iter_n_children):
	Allow iter to be set to NULL, based on patch by Don Allingham
	Fixes bug 125172

2003-12-24  Gustavo J. A. M. Carneiro  <gustavo@users.sourceforge.net>

	* pygtype.c (pyg_value_as_pyobject): Add special handling for
	GValueArray, converting it to a tuple while calling
	pyg_value_as_pyobject recursively for each inner value.

2003-12-23  James Henstridge  <james@daa.com.au>

	* gtk/gtktreeview.override
	(pygtk_tree_selection_get_selected_rows): implement (fixes bug
	#111489).

	* codegen/h2def.py (clean_func): apply patch from Jon Willeke
	<willeke@users.sourceforge.net> to strip out eg. G_BEGIN_DECLS,
	which was tripping up some of the following regexps (fixes bug
	#129414).

	* pygobject.c (pygobject_get_property): explicitly check if the
	property is readable first, and raise an exception otherwise
	(pygobject_set_property): check if property is readable (fixes bug
	#121544).

2003-12-22  James Henstridge  <james@daa.com.au>

	* setup.py: distutils fixes from Alif Wahid
	<awah005@users.sourceforge.net> (bug #123014).

	* gtk/gdk.override (ignore-win32): ignore gdk_font_get_display.

	* gtk/gtk.override (ignore): ignore plug construct functions.
	(ignore-win32): ignore gtk_plug_new_for_display.

	* gtk/gdk.defs (pixmap_foreign_new_for_display): caller owns return.
	(pixmap_foreign_new): same here (bug #129754).
	(window_foreign_new): same here.
	(window_foreign_new_for_display): same here.

2003-12-20  Gustavo J. A. M. Carneiro  <gustavo@users.sourceforge.net>

	* codegen/codegen.py (Wrapper.get_initial_constructor_substdict):
	now receives the constructor FunctionDef as argument.
	(Wrapper.write_constructor): Pass the constructor
	get_initial_constructor_substdict.
	(GObjectWrapper.get_initial_constructor_substdict): Receive/pass
	constructor argument. If constructor's caller_owns_return flag is
	set to #f, add an extra g_object_ref(self->obj).
	(GBoxedWrapper.get_initial_constructor_sub): Receive/pass extra
	constructor argument.
	(GPointerWrapper.get_initial_constructor_substdict): idem.

2003-12-17  James Henstridge  <james@daa.com.au>

	* gtk/gtk-types.defs (TextSearchFlags): GtkTextSearchFlags is a
	flags value, rather than an enum.

2003-12-16  James Henstridge  <james@daa.com.au>

	* configure.in (CFLAGS): add -fno-strict-aliasing to CFLAGS if the
	compiler supports it.  The Python API breaks some of the strict
	aliasing rules.

	* acinclude.m4 (JH_ADD_CFLAG): new macro to check whether the
	compiler supports a particular cflag.

	* codegen/codegen.py
	(GInterface.get_initial_class_substdict): GInterface wrappers
	should be sizeof(PyObject), since they are mixins.

2003-12-19  Johan Dahlin  <johan@gnome.org>

	* gtk/gdk.defs (fill): Change to guint32. Patch by
	hyriand@thegraveyard.org. Fixes 121611.

	* gtk/pygtkcellrenderer.c
	(pygtk_generic_cell_renderer_start_editing): Allow return values
	that are NULL. Patch by Tim Evans, fixes #122786

	* gtk/gtktreeview.override (_wrap_gtk_tree_model_iter_children):
	Allow parent to be None. Patch by Benjamin CAMA, fixes #124593

	* gtk/gtk.defs: Allow all GdkColor arguments for
	gtk_widget_modify_* to be null. Patch by jkluebs@luebsphoto.com,
	fixes #127178
	(GtkTreeView.expand_row): Set return value to gboolean. Patch by
	Doug Quale, fixes #126406

2003-12-18  Johan Dahlin  <johan@gnome.org>

	* gtk/gtk.defs (set_tip): Allow null for tip_text. Patch by John
	Ehresman, fixes #128623.

	* gtk/pygtktreemodel.c: handle None iterator values. Patch by John
	Ehresman, fixes #126479.

2003-12-09  Johan Dahlin  <johan@gnome.org>

	* gtk/gtktreeview.override (_wrap_gtk_list_store_reorder): Impl.

2003-12-05  Johan Dahlin  <johan@gnome.org>

	* gtk/gtktreeview.override (pygtk_tree_selection_foreach_marshal):
	Increase the ref count on Py_None (#128448, Vsevolod Fedorov)

	* gtk/gtk-types.c (pygtk_tree_model_row_get_parent): Swap parent
	and child argument. (#123605, patch by Steve Chaplin)

2003-10-23  Johan Dahlin  <jdahlin@async.com.br>

	* gtk/gtk.override (_wrap_gtk_item_factory_create_items): Use
	GdkPixbuf objects instead of raw strings, Thanks to Rob Melby for
	the patch, #123456

	* gtk/gtkwidget.override (_wrap_gtk_widget_size_request): pass
	back the values instead of pointers to them. Thanks to Rob Melby
	for the patch, #125272

2003-09-17  James Henstridge  <james@daa.com.au>

	* gtk/gtk.override (_wrap_gtk_clipboard_set_with_data): wrap
	function.

2003-09-16  James Henstridge  <james@daa.com.au>

	* gtk/gdk.override (_wrap_gdk_window_set_geometry_hints): add wrapper.
	(gdk_window_peek_children): ignore.
	(_wrap_gdk_window_set_icon_list): add wrapper.
	(_wrap_gdk_screen_get_setting): add wrapper (this one spews lots
	of warnings though.  Not sure how to fix properly).

2003-09-15  James Henstridge  <james@daa.com.au>

	* gtk/gdk.override (_wrap_gdk_display_get_window_at_pointer): add
	wrapper.
	(_wrap_gdk_drag_find_window_for_screen): add wrapper.

	* gtk/gtkgl*: remove files.

	* gtk/Makefile.am: remove gtkgl binding.

	* configure.in (build_gtkgl): remove gtkgl bindings.

2003-09-04  James Henstridge  <james@daa.com.au>

	* gtk/gtk.override (headers): add defs for GdkDisplay and GdkScreen

	* gtk/gtk.defs, gtk/gtk-types.defs: update for 2.2 APIs.  Covers
	bug #113224, #113908, #117929 and #121031.

	* gtk/gdk.override (_wrap_gdk_pixbuf_get_formats): implement
	function.  Returns a list of dictionaries (bug #118253).

2003-09-03  James Henstridge  <james@daa.com.au>

	* gtk/gdk.override: add some overrides for GdkDisplay and GdkScreen.

	* gtk/Makefile.am (gtk_overrides): gtk.c doesn't depend on
	gdk.override.

	* gtk/gdk.override: hack so that GDK_DISPLAY() is the cast macro.

	* gtk/gdk.defs, gtk/gdk-types.defs: incorporate new 2.2 APIs.

	* configure.in: set version number to 2.1.0 so that it differs
	from the 2.0 branch.

2003-09-02  James Henstridge  <james@daa.com.au>

	* ChangeLog.pre-2-0: rename old change log.

